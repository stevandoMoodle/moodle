{"version":3,"file":"embed.min.js","sources":["../src/embed.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Media plugin Embed class for Moodle.\n *\n * @module      tiny_media/embed\n * @copyright   2022 Huong Nguyen <huongnv13@gmail.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport EmbedModal from './embedmodal';\nimport {getEmbedPermissions} from './options';\nimport {getFilePicker} from 'editor_tiny/options';\nimport {EmbedHandler} from './embed/embedhandler';\nimport {insertMediaTemplateContext} from './embed/embedhelpers';\n\nexport default class MediaEmbed {\n    editor = null;\n    canShowFilePicker = false;\n    canShowFilePickerPoster = false;\n    canShowFilePickerTrack = false;\n\n    constructor(editor) {\n        const permissions = getEmbedPermissions(editor);\n        const options = getFilePicker(editor, 'media');\n\n        // Indicates whether the file picker can be shown.\n        this.canShowFilePicker = permissions.filepicker && (typeof getFilePicker(editor, 'media') !== 'undefined');\n        this.canShowFilePickerPoster = permissions.filepicker && (typeof getFilePicker(editor, 'image') !== 'undefined');\n        this.canShowFilePickerTrack = permissions.filepicker && (typeof getFilePicker(editor, 'subtitle') !== 'undefined');\n        this.canShowDropZone = Object.values(options.repositories).some(repository => repository.type === 'upload');\n        this.editor = editor;\n    }\n\n    async displayDialogue() {\n        this.currentModal = await EmbedModal.create();\n        this.root = this.currentModal.getRoot()[0];\n\n        const mediaHandler = new EmbedHandler(this);\n        mediaHandler.loadTemplatePromise(insertMediaTemplateContext(this));\n        mediaHandler.registerEventListeners(this.currentModal);\n    }\n}\n"],"names":["constructor","editor","permissions","options","canShowFilePicker","filepicker","canShowFilePickerPoster","canShowFilePickerTrack","canShowDropZone","Object","values","repositories","some","repository","type","currentModal","EmbedModal","create","root","this","getRoot","mediaHandler","EmbedHandler","loadTemplatePromise","registerEventListeners"],"mappings":"8iBAmCIA,YAAYC,sCALH,gDACW,mDACM,kDACD,SAGfC,aAAc,gCAAoBD,QAClCE,SAAU,2BAAcF,OAAQ,cAGjCG,kBAAoBF,YAAYG,iBAAyD,KAAnC,2BAAcJ,OAAQ,cAC5EK,wBAA0BJ,YAAYG,iBAAyD,KAAnC,2BAAcJ,OAAQ,cAClFM,uBAAyBL,YAAYG,iBAA4D,KAAtC,2BAAcJ,OAAQ,iBACjFO,gBAAkBC,OAAOC,OAAOP,QAAQQ,cAAcC,MAAKC,YAAkC,WAApBA,WAAWC,YACpFb,OAASA,oCAITc,mBAAqBC,oBAAWC,cAChCC,KAAOC,KAAKJ,aAAaK,UAAU,SAElCC,aAAe,IAAIC,2BAAaH,MACtCE,aAAaE,qBAAoB,4CAA2BJ,OAC5DE,aAAaG,uBAAuBL,KAAKJ"}