{"version":3,"file":"embedthumbnailpreview.min.js","sources":["../../src/embed/embedthumbnailpreview.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny media plugin embed thumbnail preview class.\n *\n * This handles:\n * - Embed thumbnail preview.\n * - Delete thumbnail preview.\n * - Update the embed preview details with new thumbnail.\n *\n * @module      tiny_media/embed/mediathumbnail\n * @copyright   2024 Stevani Andolo <stevani@hotmail.com.au>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Selectors from '../selectors';\nimport {getString} from 'core/str';\nimport {\n    sourceTypeChecked,\n    setPropertiesFromData,\n} from '../helpers';\nimport Notification from 'core/notification';\n\nexport class EmbedThumbnailPreview {\n\n    constructor(data) {\n        setPropertiesFromData(this, data); // Creates dynamic properties based on \"data\" param.\n    }\n\n    /**\n     * Init the media thumbnail preview.\n     *\n     * @param {object} mediaData Object of selected media data\n     */\n    init = (mediaData) => {\n        this.mediaData = mediaData;\n        this.currentModal.uploadThumbnailModal.setTitle(getString('thumbnail', 'tiny_media'));\n        sourceTypeChecked({\n            source: this.thumbnail,\n            root: this.thumbnailModalRoot,\n            fileNameSelector: Selectors.EMBED.elements.fileNameLabel,\n        });\n        this.setThumbnailSource();\n        this.registerMediaThumbnailEventListeners();\n    };\n\n    /**\n     * Sets media thumbnail source.\n     */\n    setThumbnailSource = () => {\n        const preview = this.thumbnailModalRoot.querySelector(Selectors.EMBED.elements.preview);\n        preview.src = this.thumbnail;\n    };\n\n    /**\n     * Deletes the media after confirming with the user and loads the insert media page.\n     */\n    deleteMedia = () => {\n        Notification.deleteCancelPromise(\n            getString('deletemediathumbnail', 'tiny_media'),\n            getString('deletemediathumbnailwarning', 'tiny_media'),\n        ).then(() => {\n            this.currentModal.uploadThumbnailModal.destroy();\n            return;\n        }).catch(error => {\n            window.console.log(error);\n        });\n    };\n\n    /**\n     * Only registers event listeners for new loaded elements in mediaThumbnail.\n     */\n    registerMediaThumbnailEventListeners = () => {\n        const deleteMedia = this.thumbnailModalRoot.querySelector(Selectors.EMBED.actions.deleteThumbnail);\n        if (deleteMedia) {\n            deleteMedia.addEventListener('click', () => {\n                this.deleteMedia();\n            });\n        }\n    };\n}\n"],"names":["constructor","data","mediaData","currentModal","uploadThumbnailModal","setTitle","source","this","thumbnail","root","thumbnailModalRoot","fileNameSelector","Selectors","EMBED","elements","fileNameLabel","setThumbnailSource","registerMediaThumbnailEventListeners","querySelector","preview","src","deleteCancelPromise","then","destroy","catch","error","window","console","log","deleteMedia","actions","deleteThumbnail","addEventListener"],"mappings":"6oBAsCIA,YAAYC,mCASJC,iBACCA,UAAYA,eACZC,aAAaC,qBAAqBC,UAAS,kBAAU,YAAa,8CACrD,CACdC,OAAQC,KAAKC,UACbC,KAAMF,KAAKG,mBACXC,iBAAkBC,mBAAUC,MAAMC,SAASC,qBAE1CC,0BACAC,qFAMY,KACDV,KAAKG,mBAAmBQ,cAAcN,mBAAUC,MAAMC,SAASK,SACvEC,IAAMb,KAAKC,iDAMT,2BACGa,qBACT,kBAAU,uBAAwB,eAClC,kBAAU,8BAA+B,eAC3CC,MAAK,UACEnB,aAAaC,qBAAqBmB,aAExCC,OAAMC,QACLC,OAAOC,QAAQC,IAAIH,0EAOY,WAC7BI,YAActB,KAAKG,mBAAmBQ,cAAcN,mBAAUC,MAAMiB,QAAQC,iBAC9EF,aACAA,YAAYG,iBAAiB,SAAS,UAC7BH,uDAlDStB,KAAMN"}