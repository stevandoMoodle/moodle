{"version":3,"file":"embedpreview.min.js","sources":["../../src/embed/embedpreview.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny media plugin embed preview and details class.\n *\n * This handles the embed file/url preview before embedding them into tiny editor.\n *\n * @module      tiny_media/embed/embedpreview\n * @copyright   2024 Stevani Andolo <stevani@hotmail.com.au>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Selectors from '../selectors';\nimport {component} from '../common';\nimport {getString} from 'core/str';\nimport {\n    sourceTypeChecked,\n    getFileName,\n    setPropertiesFromData,\n    showElements,\n    stopMediaLoading,\n    hideElements,\n} from '../helpers';\nimport {EmbedHandler} from './embedhandler';\nimport {MediaBase} from '../mediabase';\nimport Notification from 'core/notification';\nimport EmbedModal from '../embedmodal';\nimport {\n    getEmbeddedMediaDetails,\n    insertMediaThumbnailTemplateContext,\n} from './embedhelpers';\n\nexport class EmbedPreview extends MediaBase {\n\n    // Selector type for \"EMBED\".\n    selectorType = Selectors.EMBED.type;\n\n    // Fixed aspect ratio used for media links like YouTube and Vimeo.\n    linkMediaAspectRatio = 1.78;\n\n    constructor(data) {\n        super();\n        setPropertiesFromData(this, data); // Creates dynamic properties based on \"data\" param.\n    }\n\n    /**\n     * Init the media details preview.\n     */\n    init = async() => {\n        this.currentModal.setTitle(getString('mediadetails', component));\n        sourceTypeChecked({\n            source: this.mediaSource,\n            root: this.root,\n            urlSelector: Selectors.EMBED.elements.fromUrl,\n            fileNameSelector: Selectors.EMBED.elements.fileNameLabel,\n        });\n        this.setMediaSourceAndPoster();\n        this.registerMediaDetailsEventListeners(this.currentModal);\n    };\n\n    /**\n     * Sets media source and thumbnail for the video.\n     */\n    setMediaSourceAndPoster = () => {\n        const box = this.root.querySelector(Selectors.EMBED.elements.previewBox);\n        const preview = this.root.querySelector(Selectors.EMBED.elements.preview);\n        preview.src = this.mediaSource;\n\n        // Let's keep track of the original link.\n        const mediaPreviewTag = this.root.querySelector(Selectors.EMBED.elements.mediaPreviewTag);\n        mediaPreviewTag.setAttribute('data-original-url', this.originalUrl);\n\n        // Set the media name/title.\n        this.root.querySelector(Selectors.EMBED.elements.title).value = this.setMediaTitle();\n\n        // Handle error when loading the media.\n        preview.addEventListener('error', async() => {\n            // Show warning notification.\n            const urlWarningLabelEle = this.root.querySelector(Selectors.EMBED.elements.urlWarning);\n            urlWarningLabelEle.innerHTML = await getString('medianotavailabledesc', component, this.mediaSource);\n            showElements(Selectors.EMBED.elements.urlWarning, this.root);\n\n            // Stop the spinner.\n            stopMediaLoading(this.root, Selectors.EMBED.type);\n\n            // Reset the upload form.\n            (new EmbedHandler(this)).resetUploadForm();\n            return;\n        });\n\n        if (this.mediaType === 'video') {\n            if (mediaPreviewTag) { // Check if video html exists.\n                if (this.media.poster) {\n                    mediaPreviewTag.poster = this.media.poster;\n                }\n\n                // Handle media metadata loading event.\n                mediaPreviewTag.addEventListener('loadedmetadata', () => {\n                    // Stop the loader and display back the body template when the media is loaded.\n                    this.showBodyTemplate();\n\n                    const videoHeight = mediaPreviewTag.videoHeight;\n                    const videoWidth = mediaPreviewTag.videoWidth;\n                    const widthProportion = (videoWidth - videoHeight);\n                    const isLandscape = widthProportion > 0;\n\n                    // Store dimensions of the raw video.\n                    this.mediaDimensions = {\n                        width: videoWidth,\n                        height: videoHeight,\n                    };\n\n                    // Set the media preview based on the media dimensions.\n                    if (isLandscape) {\n                        mediaPreviewTag.width = box.offsetWidth;\n                    } else {\n                        mediaPreviewTag.height = box.offsetHeight;\n                    }\n\n                    const height = this.root.querySelector(Selectors.EMBED.elements.height);\n                    const width = this.root.querySelector(Selectors.EMBED.elements.width);\n\n                    if (height.value === '' && width.value === '') {\n                        height.value = videoHeight;\n                        width.value = videoWidth;\n                    }\n\n                    // Size checking and adjustment.\n                    if (videoHeight === parseInt(height.value) && videoWidth === parseInt(width.value)) {\n                        this.currentWidth = this.mediaDimensions.width;\n                        this.currentHeight = this.mediaDimensions.height;\n                        this.sizeChecked('original');\n                    } else {\n                        this.currentWidth = parseInt(width.value);\n                        this.currentHeight = parseInt(height.value);\n                        this.sizeChecked('custom');\n                    }\n                });\n\n                // Load the video html tag to load the media.\n                mediaPreviewTag.load();\n            }\n        } else if (this.mediaType === 'audio') {\n            if (mediaPreviewTag) { // Check if audio html exists.\n\n                // Handle media metadata loading event.\n                mediaPreviewTag.addEventListener('loadedmetadata', () => {\n                    // Stop the loader and display back the body template when the media is loaded.\n                    this.showBodyTemplate();\n                });\n\n                mediaPreviewTag.load();\n            }\n        } else {\n            // Stop the loader and display back the body template when the media is loaded.\n            this.showBodyTemplate();\n\n            if (this.media.poster) {\n                mediaPreviewTag.setAttribute('data-poster', this.media.poster);\n            }\n\n            // Store dimensions of the raw video.\n            this.mediaDimensions = {\n                width: null,\n                height: null,\n            };\n\n            const height = this.root.querySelector(Selectors.EMBED.elements.height);\n            const width = this.root.querySelector(Selectors.EMBED.elements.width);\n            if (height && width) {\n                if (height.value === '' && width.value === '') {\n                    this.currentWidth = this.mediaDimensions.width;\n                    this.currentHeight = this.mediaDimensions.height;\n                    this.sizeChecked('original');\n                } else {\n                    this.currentWidth = parseInt(width.value);\n                    this.currentHeight = parseInt(height.value);\n                    this.sizeChecked('custom');\n                }\n            }\n\n            // Set iframe width/height = box width/height.\n            preview.width = box.offsetWidth;\n            preview.height = box.offsetHeight;\n        }\n    };\n\n    /**\n     * Set media name/title.\n     *\n     * @returns {string}\n     */\n    setMediaTitle = () => {\n        // Getting and setting up media title/name.\n        let fileName = null;\n        if (['video', 'audio'].includes(this.mediaType)) {\n            fileName = getFileName(this.root); // Get original filename.\n        } else if (this.fetchedMediaLinkTitle) {\n            fileName = this.fetchedMediaLinkTitle;\n        }\n\n        if (this.isUpdating) {\n            if (!this.newMediaLink) {\n                fileName = this.mediaTitle; // Title from the selected media.\n            }\n        }\n\n        return fileName;\n    };\n\n    /**\n     * Stop the loader and display back the body template.\n     */\n    showBodyTemplate = () => {\n        stopMediaLoading(this.root, Selectors.EMBED.type);\n        showElements(Selectors.EMBED.elements.mediaDetailsBody, this.root);\n    };\n\n    /**\n     * Deletes the media after confirming with the user and loads the insert media page.\n     */\n    deleteMedia = () => {\n        Notification.deleteCancelPromise(\n            getString('deletemedia', component),\n            getString('deletemediawarning', component),\n        ).then(() => {\n            // Reset media upload form.\n            (new EmbedHandler(this)).resetUploadForm();\n\n            // Delete any selected media mediaData.\n            delete this.mediaData;\n            return;\n        }).catch(error => {\n            window.console.log(error);\n        });\n    };\n\n    /**\n     * Delete embedded media thumbnail.\n     */\n    deleteEmbeddedThumbnail = () => {\n        Notification.deleteCancelPromise(\n            getString('deleteembeddedthumbnail', component),\n            getString('deleteembeddedthumbnailwarning', component),\n        ).then(async() => {\n            const mediaPreviewTag = this.root.querySelector(Selectors.EMBED.elements.mediaPreviewTag);\n            if (this.mediaType === 'link') {\n                mediaPreviewTag.removeAttribute('data-poster');\n            } else {\n                mediaPreviewTag.removeAttribute('poster');\n            }\n\n            const deleteCustomThumbnail = this.root.querySelector(Selectors.EMBED.actions.deleteCustomThumbnail);\n            deleteCustomThumbnail.remove();\n\n            const uploadCustomThumbnail = this.root.querySelector(Selectors.EMBED.actions.uploadCustomThumbnail);\n            uploadCustomThumbnail.textContent = await getString('uploadthumbnail', component);\n            return;\n        }).catch(error => {\n            window.console.log(error);\n        });\n    };\n\n    /**\n     * Shows the insert thumbnail dialogue.\n     */\n    showUploadThumbnail = async() => {\n        const uploadThumbnailModal = await EmbedModal.create({\n            large: true,\n            templateContext: {elementid: this.editor.getElement().id},\n        });\n        const root = uploadThumbnailModal.getRoot()[0];\n\n        // Get selected media metadata.\n        const mediaData = getEmbeddedMediaDetails(this);\n        mediaData.isUpdating = this.isUpdating;\n\n        const embedHandler = new EmbedHandler(this);\n        embedHandler.loadInsertThumbnailTemplatePromise(\n            insertMediaThumbnailTemplateContext(this), // Get template context for creating media thumbnail.\n            {root, uploadThumbnailModal}, // Required root elements.\n            await embedHandler.getMediaTemplateContext(mediaData) // Get current media data.\n        );\n    };\n\n    /**\n     * Only registers event listeners for new loaded elements in embed preview modal.\n     */\n    registerMediaDetailsEventListeners = async() => {\n        // Handle the original size when selected.\n        const sizeOriginalEle = this.root.querySelector(Selectors.EMBED.elements.sizeOriginal);\n        if (sizeOriginalEle) {\n            sizeOriginalEle.addEventListener('change', () => {\n                this.sizeChecked('original');\n            });\n        }\n\n        // Handle the custom size when selected.\n        const sizeCustomEle = this.root.querySelector(Selectors.EMBED.elements.sizeCustom);\n        if (sizeCustomEle) {\n            sizeCustomEle.addEventListener('change', () => {\n                this.sizeChecked('custom');\n            });\n        }\n\n        const widthEle = this.root.querySelector(Selectors.EMBED.elements.width);\n        const heightEle = this.root.querySelector(Selectors.EMBED.elements.height);\n\n        // Handle the custom with size when inputted.\n        if (widthEle) {\n            widthEle.addEventListener('input', () => {\n                if (this.mediaType === 'link') {\n                    // Let's apply the 16:9 aspect ration if it's a link media type.\n                    heightEle.value = Math.round(widthEle.value / this.linkMediaAspectRatio);\n                } else {\n                    // Avoid empty value.\n                    widthEle.value = widthEle.value === \"\" ? 0 : Number(widthEle.value);\n                    this.autoAdjustSize();\n                }\n            });\n        }\n\n        // Handle the custom height size when inputted.\n        if (heightEle) {\n            heightEle.addEventListener('input', () => {\n                if (this.mediaType === 'link') {\n                    // Let's apply the 16:9 aspect ration if it's a link media type.\n                    widthEle.value = Math.round(heightEle.value * this.linkMediaAspectRatio);\n                } else {\n                    // Avoid empty value.\n                    heightEle.value = heightEle.value === \"\" ? 0 : Number(heightEle.value);\n                    this.autoAdjustSize(true);\n                }\n            });\n        }\n\n        // Handle media preview delete.\n        const deleteMedia = this.root.querySelector(Selectors.EMBED.actions.deleteMedia);\n        if (deleteMedia) {\n            deleteMedia.addEventListener('click', (e) => {\n                e.preventDefault();\n                this.deleteMedia();\n            });\n        }\n\n        // Show subtitles and captions settings.\n        const showSubtitleCaption = this.root.querySelector(Selectors.EMBED.actions.showSubtitleCaption);\n        if (showSubtitleCaption) {\n            showSubtitleCaption.addEventListener('click', (e) => {\n                e.preventDefault();\n                hideElements([\n                    Selectors.EMBED.actions.showSubtitleCaption,\n                    Selectors.EMBED.actions.cancelMediaDetails,\n                    Selectors.EMBED.elements.mediaDetailsBody,\n                ], this.root);\n                showElements([\n                    Selectors.EMBED.actions.backToMediaDetails,\n                    Selectors.EMBED.elements.mediaSubtitleCaptionBody,\n                ], this.root);\n            });\n        }\n\n        // Back to media preview.\n        const backToMediaDetails = this.root.querySelector(Selectors.EMBED.actions.backToMediaDetails);\n        if (backToMediaDetails) {\n            backToMediaDetails.addEventListener('click', () => {\n                hideElements([\n                    Selectors.EMBED.actions.backToMediaDetails,\n                    Selectors.EMBED.elements.mediaSubtitleCaptionBody,\n                ], this.root);\n                showElements([\n                    Selectors.EMBED.actions.showSubtitleCaption,\n                    Selectors.EMBED.actions.cancelMediaDetails,\n                    Selectors.EMBED.elements.mediaDetailsBody,\n                ], this.root);\n            });\n        }\n\n        const uploadCustomThumbnail = this.root.querySelector(Selectors.EMBED.actions.uploadCustomThumbnail);\n        if (uploadCustomThumbnail) {\n            uploadCustomThumbnail.addEventListener('click', () => {\n                this.showUploadThumbnail();\n            });\n        }\n\n        const deleteCustomThumbnail = this.root.querySelector(Selectors.EMBED.actions.deleteCustomThumbnail);\n        if (deleteCustomThumbnail) {\n            deleteCustomThumbnail.addEventListener('click', () => {\n                this.deleteEmbeddedThumbnail();\n            });\n        }\n\n        const mediaLinkEmbedType = this.root.querySelector(Selectors.EMBED.elements.mediaLinkEmbedType);\n        if (mediaLinkEmbedType) {\n            mediaLinkEmbedType.addEventListener('change', () => {\n                const mediaType = mediaLinkEmbedType.value;\n                this.mediaTagType = mediaType;\n                if (mediaType === 'audio') {\n                    hideElements([\n                        Selectors.EMBED.elements.mediaSizeProperties,\n                        Selectors.EMBED.elements.videoThumbnail,\n                        Selectors.EMBED.actions.showSubtitleCaption,\n                    ], this.root);\n                } else {\n                    showElements([\n                        Selectors.EMBED.elements.mediaSizeProperties,\n                        Selectors.EMBED.elements.videoThumbnail,\n                        Selectors.EMBED.actions.showSubtitleCaption,\n                    ], this.root);\n                }\n            });\n        }\n    };\n}\n"],"names":["EmbedPreview","MediaBase","constructor","data","Selectors","EMBED","type","async","currentModal","setTitle","component","source","this","mediaSource","root","urlSelector","elements","fromUrl","fileNameSelector","fileNameLabel","setMediaSourceAndPoster","registerMediaDetailsEventListeners","box","querySelector","previewBox","preview","src","mediaPreviewTag","setAttribute","originalUrl","title","value","setMediaTitle","addEventListener","urlWarning","innerHTML","EmbedHandler","resetUploadForm","mediaType","media","poster","showBodyTemplate","videoHeight","videoWidth","isLandscape","mediaDimensions","width","height","offsetWidth","offsetHeight","parseInt","currentWidth","currentHeight","sizeChecked","load","fileName","includes","fetchedMediaLinkTitle","isUpdating","newMediaLink","mediaTitle","mediaDetailsBody","deleteCancelPromise","then","mediaData","catch","error","window","console","log","removeAttribute","actions","deleteCustomThumbnail","remove","uploadCustomThumbnail","textContent","uploadThumbnailModal","EmbedModal","create","large","templateContext","elementid","editor","getElement","id","getRoot","embedHandler","loadInsertThumbnailTemplatePromise","getMediaTemplateContext","sizeOriginalEle","sizeOriginal","sizeCustomEle","sizeCustom","widthEle","heightEle","Math","round","linkMediaAspectRatio","Number","autoAdjustSize","deleteMedia","e","preventDefault","showSubtitleCaption","cancelMediaDetails","backToMediaDetails","mediaSubtitleCaptionBody","showUploadThumbnail","deleteEmbeddedThumbnail","mediaLinkEmbedType","mediaTagType","mediaSizeProperties","videoThumbnail"],"mappings":"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"}