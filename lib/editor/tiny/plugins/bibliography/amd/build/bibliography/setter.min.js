define("tiny_bibliography/bibliography/setter",["exports","core/str","./../common","./style_source_selector","./templateloader","./helper","./example"],(function(_exports,_str,_common,_style_source_selector,_templateloader,_helper,_example){var obj;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_style_source_selector=(obj=_style_source_selector)&&obj.__esModule?obj:{default:obj};class Setter extends _style_source_selector.default{constructor(){var _this;super(),_this=this,_defineProperty(this,"initSetter",(async()=>{this.allData.style=this.DEFAULT.STYLE,this.setSelectedStyle(this.DEFAULT.STYLE),await this.setSelectedSource()})),_defineProperty(this,"setStyle",(function(){let data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_this.allData.style=data,_this.setSelectedStyle(data)})),_defineProperty(this,"setSource",(async function(){let data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;data||(data=_this.selectedStyle.DEFAULT.SOURCE),_this.fields=[],await _this.setSelectedSource(data),_this.removeListeners(),await _this.loadFieldTemplate(),_this.addListeners(),_this.resetBibliographyContainerHeight()})),_defineProperty(this,"addListeners",(()=>{(0,_example.getExample)(this),this.addClickListeners(),this.addChangeListeners(),this.addKeyupListeners()})),_defineProperty(this,"removeListeners",(()=>{(0,_example.removeAttachedExampleListeners)(),this.removeAttachedClickListeners(),this.removeAttachedChangeListeners(),this.removeAttachedKeyupListeners()})),_defineProperty(this,"loadFieldTemplate",(async()=>{let status=!1;status=void 0!==this.allData.showOtherFields&&("string"==typeof this.allData.showOtherFields?"true"===this.allData.showOtherFields:this.allData.showOtherFields),this.allData.showOtherFields=status;const template=await(0,_templateloader.fieldTemplate)({...this,fields:await this.requiredFieldObject()});(0,_helper.byId)("main-input-fields").innerHTML=template})),_defineProperty(this,"requiredFieldObject",(async()=>{let labelArray=[];this.fields.forEach((field=>{labelArray.push(field.label)}));const labels=await(0,_str.getStrings)(labelArray.map((key=>({key:key,component:_common.component}))));let fields=[],i=0;return this.fields.forEach((field=>{var _field$required;fields.push({data:field.author?this.allData["pure".concat((0,_helper.ucFirst)(field.field))]:this.allData[field.field],field:field.field,label:labels[i],example:field.example,inputType:field.inputType,author:field.author,show:null!==(_field$required=field.required)&&void 0!==_field$required?_field$required:this.allData.showOtherFields,required:this.allData.showOtherFields?field.required:this.allData.showOtherFields}),i++})),fields}))}splitAuthorName(){let field=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const data=this.allData[field];if(this.allData["pure".concat((0,_helper.ucFirst)(field))]=data,this.allData[field]="",data)if(!0===data.includes(";")){data.split(";").forEach((author=>{""!==(author=author.trim())&&this.setGeneratedAuthorNames(this.generateDetailedAuthorName(author),field)}))}else this.setGeneratedAuthorNames(this.generateDetailedAuthorName(data),field)}setGeneratedAuthorNames(){let names=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,field=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;""!==this.allData[field]?this.allData[field]+=", "+names:this.allData[field]=names}generateDetailedAuthorName(){let author=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,sureName="",firstName="",middleName="";if(author.includes(",")){const names=author.split(",");sureName=names[0];let fmName=names[1];if(fmName.includes(" ")){fmName=fmName.split(" ");let i=0;fmName.forEach((fm=>{""!==fm&&(0===i?firstName=fm:middleName+=fm+" ",i++)}))}else firstName=fmName}else firstName=author;return this.selectedStyle.generateAuthorName(firstName.trim(),middleName.trim(),sureName.trim()).generated}setCustomAuthorNames(event){const customAuthorName=event.target.closest('[data-action="custom-bibliography-author"]');if(customAuthorName){const field=customAuthorName.dataset.field;(0,_helper.hideElement)(["full-".concat(field,"-holder"),"generate-button"]),(0,_helper.showElement)(["custom-".concat(field,"-holder")])}const cancelCustom=event.target.closest('[data-action="cancel-custom-bibliography-author"]');if(cancelCustom){const field=cancelCustom.dataset.field;(0,_helper.showElement)(["full-".concat(field,"-holder"),"generate-button"]),(0,_helper.hideElement)(["custom-".concat(field,"-holder")])}const okCustom=event.target.closest('[data-action="ok-custom-bibliography-author"]');if(okCustom){const field=okCustom.dataset.field,fullName=this.selectedStyle.generateAuthorName((0,_helper.byId)("id_bibliography_".concat(field,"_firstname")).value,(0,_helper.byId)("id_bibliography_".concat(field,"_middlename")).value,(0,_helper.byId)("id_bibliography_".concat(field,"_surename")).value).originated.trim();let oriData=(0,_helper.byId)("id_bibliography_".concat(field)).value;""===oriData?oriData=fullName:oriData+="; "+fullName,this.allData[field]=oriData,this.splitAuthorName(field),this.allData["pure".concat((0,_helper.ucFirst)(field))]=oriData,(0,_helper.byId)("id_bibliography_".concat(field)).value=oriData,(0,_helper.byId)("id_bibliography_".concat(field,"_firstname")).value="",(0,_helper.byId)("id_bibliography_".concat(field,"_middlename")).value="",(0,_helper.byId)("id_bibliography_".concat(field,"_surename")).value="",(0,_helper.showElement)(["full-".concat(field,"-holder"),"generate-button"]),(0,_helper.hideElement)(["custom-".concat(field,"-holder")])}}}return _exports.default=Setter,_exports.default}));

//# sourceMappingURL=setter.min.js.map