define("tiny_bibliography/bibliography/styles/ieee",["exports","core/templates","core/str","core/notification","./../helper","./../templateloader","../base","../../common","../handlers/book","../handlers/website","../handlers/book_with_chapter_title"],(function(_exports,_templates,_str,_notification,_helper,_templateloader,_base,_common,_book,_website,_book_with_chapter_title){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_templates=_interopRequireDefault(_templates),_base=_interopRequireDefault(_base),_book=_interopRequireDefault(_book),_website=_interopRequireDefault(_website),_book_with_chapter_title=_interopRequireDefault(_book_with_chapter_title);class Ieee extends _base.default{constructor(){var _this;super(),_this=this,_defineProperty(this,"setSelectedSource",(async function(){let selectedSource,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;switch(data||(data=_this.DEFAULT.SOURCE),data){case"book":selectedSource=new _book.default;break;case"website":selectedSource=new _website.default;break;case"book_with_chapter_title":selectedSource=new _book_with_chapter_title.default;break;default:selectedSource=new _book.default,(0,_helper.byId)("id_bibliography_source").value=_this.DEFAULT.SOURCE,(0,_notification.alert)(await(0,_str.get_string)("alert:warning",_common.component),await(0,_str.get_string)("sourcenotavailable",_common.component,(0,_helper.toWords)("_",data)))}return selectedSource})),_defineProperty(this,"deleteBibliography",(bio=>{const list=bio.editor.dom.select('[class="'.concat(bio.deleteBio.dataset.id,'"]')),index=parseInt(bio.deleteBio.dataset.index);if(list){bio.editor.dom.select('[class="cited-bibliography"]').forEach((ref=>{const text=(0,_helper.getInTextRefNumber)(ref);parseInt(text)===index&&ref.remove()})),this.reorderCitation(bio.editor,index,!1),list[0].remove(),this.reorderBibliography(bio.editor),bio.modal.hide()}})),_defineProperty(this,"reorderBibliography",(editor=>{let bioList=editor.dom.select('[id="id-bibliography-holder"]');if(1===bioList[0].childNodes.length&&bioList[0].remove(),bioList.length>0){let index=1;bioList[0].childNodes.forEach((node=>{if("P"===node.nodeName&&""!==node.textContent.trim()){const targetRefNo=node.querySelectorAll("span")[1].querySelectorAll("span")[0];targetRefNo&&(targetRefNo.removeAttribute("class"),targetRefNo.classList.add("id-refno-".concat(index)),targetRefNo.textContent="[".concat(index,"]"),node.removeAttribute("class"),node.classList.add("id-bibliography-list-".concat(index)),index++)}}))}})),_defineProperty(this,"reorderCitation",(function(editor,refNumber){let increase=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const refList=editor.dom.select('[class="cited-bibliography"]');refList.length>0&&refList.forEach((ref=>{const content=parseInt((0,_helper.getInTextRefNumber)(ref));content>=refNumber&&(ref.textContent="[".concat(content-1,"]"),increase&&(ref.textContent="[".concat(content+1,"]")))}))})),_defineProperty(this,"generateBibliography",(async bio=>{if(this.checkRequiredFields(bio)){if(bio.create){let bioList=bio.editor.dom.select('[id="id-bibliography-holder"]'),index=bioList.length;index>0&&(index=bioList[0].querySelectorAll("p").length),bio.updateIndex=index+1,bio.allData.author=(0,_helper.wordsFormat)(bio.allData.author),window.console.log("index",bio.updateIndex);let bibliography,info=await(0,_templateloader.getBioContent)(bio);if(0===index&&(info=await(0,_templateloader.firstItem)({reference:info,referenceNumber:bio.updateIndex})),bibliography=index>0?info:await _templates.default.render("tiny_bibliography/bibliography_header",{info:info}),bibliography=bibliography.replaceAll(/\r?\n|\r/g,""),0===index)window.console.log("first item"),bio.editor.dom.add(bio.editor.getBody(),"div",{id:"id-bibliography-holder"},bibliography),this.scrollToBottom(bio);else{const currentElement=bio.editor.selection.getNode().parentElement.parentElement,elementClass=currentElement.getAttribute("class");if(window.console.log(elementClass),currentElement&&elementClass&&elementClass.includes("id-bibliography-list-")){window.console.log("and so on item");const textNodes=this.getTextNodes(currentElement);bio.editor.selection.setCursorLocation(textNodes[textNodes.length-1],textNodes[textNodes.length-1].textContent.length);const newshit=await(0,_templateloader.firstItem)({reference:info,referenceNumber:bio.updateIndex});await bio.editor.insertContent(newshit);let refNo=elementClass.split("-");refNo=parseInt(refNo[refNo.length-1])+1,this.reorderCitation(bio.editor,refNo,!0),this.reorderBibliography(bio.editor)}else window.console.log("second item"),bio.editor.dom.add(bioList[0],"p",{class:"id-bibliography-list-".concat(bio.updateIndex)},bibliography),this.scrollToBottom(bio)}}else{bio.editor.dom.select('[class="'.concat(bio.updateId,'"]'))[0].innerHTML=await(0,_templateloader.getBioContent)(bio),bio.create=!0}(0,_helper.resetBibliographyFormFields)(bio),bio.generateBioAndDisplayInModal()}else(0,_notification.alert)(await(0,_str.get_string)("alert:error",_common.component),await(0,_str.get_string)("fieldsrequired",_common.component))})),this.DEFAULT={SOURCE:"book"},this.ALL_SOURCES=["source:book","source:website","source:book_with_chapter_title"]}generateAuthorName(){let firstName=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,middleName=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,sureName=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!==firstName){var _sureName,_middleName;const genSureName=sureName?(0,_helper.ucFirst)(sureName):"";sureName=sureName?sureName+", ":null;let genMiddleName="",genFirstName="";return sureName?(genMiddleName=middleName?(0,_helper.ucFirst)(middleName,!1)+". ":"",middleName=middleName?middleName+"":null):(genMiddleName=middleName?(0,_helper.ucFirst)(middleName,!1):"",middleName=middleName||null),sureName||middleName?(genFirstName=firstName?(0,_helper.ucFirst)(firstName,!1)+". ":"",firstName=firstName?firstName+" ":""):(genFirstName=firstName?(0,_helper.ucFirst)(firstName,!1):"",firstName=firstName||""),{generated:genFirstName+genMiddleName+genSureName,originated:(null!==(_sureName=sureName)&&void 0!==_sureName?_sureName:", ")+firstName+(null!==(_middleName=middleName)&&void 0!==_middleName?_middleName:"")}}return null}}return _exports.default=Ieee,_exports.default}));

//# sourceMappingURL=ieee.min.js.map