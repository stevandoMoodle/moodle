define("tool_componentlibrary/mustache",["exports","tool_componentlibrary/selectors","core/ajax","core/config","core/templates","core/log","core/notification"],(function(_exports,_selectors,_ajax,_config,_templates,_log,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.mustache=void 0,_selectors=_interopRequireDefault(_selectors),_ajax=_interopRequireDefault(_ajax),_config=_interopRequireDefault(_config),_templates=_interopRequireDefault(_templates),_log=_interopRequireDefault(_log),_notification=_interopRequireDefault(_notification);var fn,_ref,renderTemplate=(fn=regeneratorRuntime.mark((function _callee(container,templateName,context){var _yield$Templates$rend,html,js,rendercontainer;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:try{context=JSON.parse(context)}catch(e){_log.default.debug("Could not parse json example context for template."),_log.default.debug(e)}return _context.next=3,_templates.default.renderForPromise(templateName,context);case 3:return _yield$Templates$rend=_context.sent,html=_yield$Templates$rend.html,js=_yield$Templates$rend.js,rendercontainer=container.querySelector(_selectors.default.mustacherendered),_context.next=9,_templates.default.replaceNodeContents(rendercontainer,html,js);case 9:case"end":return _context.stop()}}),_callee)})),_ref=function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))},function(_x,_x2,_x3){return _ref.apply(this,arguments)});_exports.mustache=function(){document.querySelectorAll(_selectors.default.mustachecode).forEach((function(container){!function(container){var sourcecontainer=container.querySelector(_selectors.default.mustachesource),contextcontainer=container.querySelector(_selectors.default.mustachecontext),templateName=container.dataset.template,context=container.querySelector(_selectors.default.mustacherawcontext).textContent,parts=templateName.split("/"),request={methodname:"core_output_load_template",args:{component:parts.shift(),template:parts.join("/"),themename:_config.default.theme,includecomments:!0}};_ajax.default.call([request])[0].done((function(source){if(sourcecontainer.textContent=source,!context){var example=source.match(/Example context \(json\):([\s\S]+?)(}})/);context=example[1];var precontainer=document.createElement("pre");precontainer.innerHTML=JSON.stringify(JSON.parse(context),null,4),contextcontainer.parentNode.appendChild(precontainer),contextcontainer.classList.add("d-none")}renderTemplate(container,templateName,context)})).fail(_notification.default.exception)}(container)}))}}));

//# sourceMappingURL=mustache.min.js.map